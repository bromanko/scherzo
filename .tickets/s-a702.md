---
id: s-a702
status: open
deps: [s-a701]
links: []
created: 2026-01-22T18:45:00Z
type: task
priority: 2
assignee: Brian Romanko
parent: s-a700
tags: [phase-5g, config]
---
# Create settings merger

Create `src/scherzo/config/settings_merger.gleam` to merge custom settings.json with auto-generated settings.

## Implementation

```gleam
pub fn merge(auto_generated: String, custom: String) -> Result(String, String)
```

## Merge Rules

1. Hooks are merged by event type:
   - Auto-generated hooks preserved for each event
   - Custom hooks appended to same event's array
   - New events from custom added
2. Other top-level fields: custom overrides auto-generated

## Hook Format

Must handle Claude Code's nested structure (see `claude_settings.gleam`):

```json
{
  "hooks": {
    "SessionStart": [{"matcher": "", "hooks": [...]}],
    "Stop": [...]
  }
}
```

## Acceptance Criteria

- [ ] Merges hook objects by event type correctly
- [ ] Custom hooks for same event appended (not replaced)
- [ ] Custom hooks for new events added
- [ ] Non-hook settings override
- [ ] Returns error for invalid JSON
- [ ] Unit tests in `test/scherzo/config/settings_merger_test.gleam`
